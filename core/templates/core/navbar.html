{% load static %}
<div class="sticky top-0 z-50">
  <header class="p-4 flex items-center justify-between flex-wrap bg-[#e6f7f3] shadow-md">
    <!-- Logo Section -->
    <div class="w-20">
      <a href="{% url 'home' %}">
        <img src="{% static 'core/images/main-logo.png' %}" alt="Mobzilla Logo" class="w-full" id="logo" />
      </a>
    </div>

    <!-- Mobile menu button -->
    <button id="menu-btn" class="md:hidden text-3xl text-gray-700" x-data @click="mobileMenuOpen = !mobileMenuOpen">
      <span x-show="!mobileMenuOpen">&#9776;</span>
      <span x-show="mobileMenuOpen">&times;</span>
    </button>

    <!-- Desktop Navigation -->
    <nav id="nav-links" class="hidden w-full md:w-auto md:flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-8 mt-4 md:mt-0 text-lg text-center" 
         x-data="{ mobileMenuOpen: false }" 
         :class="{ 'hidden': !mobileMenuOpen }" 
         x-show="mobileMenuOpen || window.innerWidth >= 768">
      <a href="{% url 'home' %}" 
         class="px-2 py-1 {% if request.resolver_match.url_name == 'home' %}active-nav{% endif %}">
        Home
      </a>
      <a href="{% url 'courses' %}" 
         class="px-2 py-1 {% if request.resolver_match.url_name == 'courses' %}active-nav{% endif %}">
        Courses
      </a>
      <a href="{% url 'about' %}" 
         class="px-2 py-1 {% if request.resolver_match.url_name == 'about' %}active-nav{% endif %}">
        About
      </a>

      <a href="{% url 'blog' %}" 
         class="px-2 py-1 {% if request.resolver_match.url_name == 'blog' %}active-nav{% endif %}">
        Blog
      </a>
      <a href="{% url 'contact' %}" 
         class="px-2 py-1 {% if request.resolver_match.url_name == 'contact' %}active-nav{% endif %}">
        Contact
      </a>
      <a href="#" class="px-2 py-1">Fixit</a>
    </nav>

    <!-- Right Side Icons and User Section -->
    <div class="flex items-center space-x-4 mt-4 md:mt-0">
      <!-- Wishlist Heart Icon -->
      <div class="relative cursor-pointer">
        <a href="#" title="Wishlist">
          <i class="fa-regular fa-heart text-2xl text-gray-700"></i>
        </a>
      </div>

      <!-- Cart Icon -->
      <div class="relative cursor-pointer">
        <a href="#" title="Shopping Cart">
          <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="#1c2d4a" viewBox="0 0 24 24">
            <path d="M7 18c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm0 2a.001.001 0 0 0 0 0h0zm10-2c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm0 2a.001.001 0 0 0 0 0h0zM7.24 14l.94-2h8.24a1 1 0 0 0 .96-.73l2.5-8A1 1 0 0 0 18 2H5.21l-.94-2H1v2h2l3.6 7.59-1.35 2.44A1.992 1.992 0 0 0 4 15c0 1.104.896 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.07-.25z"></path>
          </svg>
        </a>
        <span id="cart-count" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">
          0
        </span>
      </div>

      <!-- User Authentication Section -->
      {% if user.is_authenticated %}
        <!-- Authenticated User Dropdown -->
        <div class="relative" x-data="{ open: false }">
          <button @click="open = !open" 
                  class="flex items-center text-gray-700 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-gray-300 rounded-full p-1"
                  title="User Menu">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-7 text-black" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
            </svg>
            <span class="ml-1 text-sm font-medium text-gray-700 hidden md:inline">{{ user.username }}</span>
            <svg class="ml-1 w-4 h-4 text-gray-700 hidden md:inline" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
            </svg>
          </button>
          
          <!-- Dropdown Menu -->
          <div x-show="open" 
               @click.away="open = false"
               x-transition:enter="transition ease-out duration-100"
               x-transition:enter-start="transform opacity-0 scale-95"
               x-transition:enter-end="transform opacity-100 scale-100"
               x-transition:leave="transition ease-in duration-75"
               x-transition:leave-start="transform opacity-100 scale-100"
               x-transition:leave-end="transform opacity-0 scale-95"
               class="origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-50">
            <div class="py-1">
              <div class="px-4 py-2 text-sm text-gray-500 border-b">
                <div class="font-medium">{{ user.username }}</div>
                <div class="text-xs">{{ user.email }}</div>
              </div>
              <a href="{% url 'profile' %}" 
                 class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                <i class="fas fa-user w-4 mr-2"></i>Profile
              </a>
              <a href="{% url 'dashboard' %}" 
                 class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                <i class="fas fa-tachometer-alt w-4 mr-2"></i>Dashboard
              </a>
              <hr class="my-1">
              <form method="post" action="{% url 'logout' %}" class="block">
                {% csrf_token %}
                <button type="submit" 
                        class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                  <i class="fas fa-sign-out-alt w-4 mr-2"></i>Logout
                </button>
              </form>
            </div>
          </div>
        </div>
      {% else %}
        <!-- Non-authenticated User Icon -->
        <a href="{% url 'login' %}" title="Login" class="text-gray-700 hover:text-gray-900">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-7 text-black" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
          </svg>
        </a>
      {% endif %}
    </div>

    <!-- Mobile Navigation Menu -->
    <div x-data="{ mobileMenuOpen: false }" 
         x-show="mobileMenuOpen" 
         x-transition:enter="transition ease-out duration-200"
         x-transition:enter-start="opacity-0 transform scale-95"
         x-transition:enter-end="opacity-100 transform scale-100"
         x-transition:leave="transition ease-in duration-100"
         x-transition:leave-start="opacity-100 transform scale-100"
         x-transition:leave-end="opacity-0 transform scale-95"
         class="md:hidden w-full mt-4 bg-white bg-opacity-90 backdrop-blur-sm rounded-lg shadow-lg">
      <div class="px-4 py-3 space-y-2">
        <a href="{% url 'home' %}" 
           class="block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-md {% if request.resolver_match.url_name == 'home' %}bg-gray-100{% endif %}">
          Home
        </a>

        <a href="{% url 'courses' %}" 
           class="block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-md {% if request.resolver_match.url_name == 'courses' %}bg-gray-100{% endif %}">
          Courses
        </a>
        <a href="{% url 'about' %}" 
           class="block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-md {% if request.resolver_match.url_name == 'about' %}bg-gray-100{% endif %}">
          About
        </a>

        <a href="{% url 'blog' %}" 
           class="block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-md {% if request.resolver_match.url_name == 'blog' %}bg-gray-100{% endif %}">
          Blog
        </a>
        <a href="{% url 'contact' %}" 
           class="block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-md {% if request.resolver_match.url_name == 'contact' %}bg-gray-100{% endif %}">
          Contact
        </a>
        <a href="#" 
           class="block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-md">
          Fixit
        </a>
      </div>
      
      <!-- Mobile Auth Section -->
      <div class="border-t border-gray-200 pt-3 pb-3">
        {% if user.is_authenticated %}
          <div class="flex items-center px-4 pb-3">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 text-gray-600" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
            </svg>
            <div class="ml-3">
              <div class="text-base font-medium text-gray-800">{{ user.username }}</div>
              <div class="text-sm font-medium text-gray-600">{{ user.email }}</div>
            </div>
          </div>
          <div class="space-y-1 px-4">
            <a href="{% url 'profile' %}" 
               class="block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-md">
              Profile
            </a>
            <a href="{% url 'dashboard' %}" 
               class="block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-md">
              Dashboard
            </a>
            <form method="post" action="{% url 'logout' %}" class="block">
              {% csrf_token %}
              <button type="submit" 
                      class="w-full text-left px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-md">
                Logout
              </button>
            </form>
          </div>
        {% else %}
          <div class="px-4 space-y-2">
            <a href="{% url 'login' %}" 
               class="block w-full text-center bg-gray-800 text-white hover:bg-gray-700 px-4 py-2 rounded-md text-base font-medium transition duration-300">
              Login
            </a>
            <a href="{% url 'register' %}" 
               class="block w-full text-center text-gray-700 hover:text-gray-900 px-4 py-2 rounded-md text-base font-medium border border-gray-300 hover:border-gray-400 transition duration-300">
              Register
            </a>
          </div>
        {% endif %}
      </div>
    </div>
  </header>
</div>

<!-- CSS for active navigation styling -->
<style>
.active-nav {
  color: #059669; /* Green color for active state */
  font-weight: 600;
  border-bottom: 2px solid #059669;
}

/* Hover effects for navigation links */
nav a:hover:not(.active-nav) {
  color: #047857;
  transition: color 0.3s ease;
}

/* Mobile menu button animation */
#menu-btn {
  transition: transform 0.2s ease;
}

#menu-btn:hover {
  transform: scale(1.1);
}
</style>

<!-- JavaScript for mobile menu functionality (if not using Alpine.js) -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  const menuBtn = document.getElementById('menu-btn');
  const navLinks = document.getElementById('nav-links');
  
  if (menuBtn && navLinks) {
    menuBtn.addEventListener('click', function() {
      navLinks.classList.toggle('hidden');
    });
  }
});
</script>